{"version":3,"sources":["../../src/middlewares/otp.ts"],"sourcesContent":["import { Request, Response, NextFunction } from \"express\";\r\nimport rateLimit from \"express-rate-limit\";\r\n\r\nconst otpLimiter = rateLimit({\r\n\twindowMs: 15 * 60 * 1000,\r\n\tmax: 5,\r\n\tmessage: {\r\n\t\tsuccess: false,\r\n\t\terror: \"Rate limit exceeded. Please try again later.\",\r\n\t},\r\n});\r\n\r\nconst otpMiddleware = (\r\n\treq: Request,\r\n\tres: Response,\r\n\tnext: NextFunction,\r\n): void => {\r\n\totpLimiter(req, res, (err) => {\r\n\t\tif (err) {\r\n\t\t\treturn res.status(429).json({ success: false, error: err.message });\r\n\t\t} else {\r\n\t\t\tnext();\r\n\t\t}\r\n\t});\r\n};\r\n\r\nexport default otpMiddleware;\r\n"],"names":["otpLimiter","rateLimit","windowMs","max","message","success","error","otpMiddleware","req","res","next","err","status","json"],"mappings":";;;;+BA0BA;;;eAAA;;;2DAzBsB;;;;;;AAEtB,MAAMA,aAAaC,IAAAA,yBAAS,EAAC;IAC5BC,UAAU,KAAK,KAAK;IACpBC,KAAK;IACLC,SAAS;QACRC,SAAS;QACTC,OAAO;IACR;AACD;AAEA,MAAMC,gBAAgB,CACrBC,KACAC,KACAC;IAEAV,WAAWQ,KAAKC,KAAK,CAACE;QACrB,IAAIA,KAAK;YACR,OAAOF,IAAIG,MAAM,CAAC,KAAKC,IAAI,CAAC;gBAAER,SAAS;gBAAOC,OAAOK,IAAIP,OAAO;YAAC;QAClE,OAAO;YACNM;QACD;IACD;AACD;MAEA,WAAeH"}